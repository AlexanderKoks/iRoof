<div class="map-wrapper">
    <!-- Map -->
    <div id="map"></div>
  
    <!-- Controls -->
    <div class="controls">
      <div class="control-row">
        <label for="pitch">Roof pitch angle (Â°):</label>
        <input id="pitch" type="number" [(ngModel)]="pitchAngle" />
        <button (click)="calculateArea()">Calculate area</button>
        <button (click)="resetCalculation()">Reset calculation</button>
      </div>
      
      <div class="control-row edit-controls">
        <button 
          (click)="toggleEditMode()" 
          [class.active]="editModeState.isEditing"
          [disabled]="polygonPoints.length === 0">
          {{ editModeState.isEditing ? 'Exit Edit Mode' : 'Edit Roof Edges' }}
        </button>
        <button 
          (click)="togglePitchDrawingMode()" 
          [class.active]="editModeState.isPitchDrawing"
          [disabled]="polygonPoints.length === 0">
          {{ editModeState.isPitchDrawing ? 'Exit Pitch Drawing' : 'Draw Pitch Angles' }}
        </button>
        <button 
          (click)="clearPitchAngles()"
          [disabled]="pitchAngles.length === 0">
          Clear Pitch Angles
        </button>
      </div>

      <div class="control-row">
        <button (click)="exportToPDF()">Export to PDF</button>
      </div>

      <div class="layer-toggle">
        <label>
          <input type="radio" [(ngModel)]="mapLayer" (change)="switchLayer()" value="satellite" /> Satellite
        </label>
        <label>
          <input type="radio" [(ngModel)]="mapLayer" (change)="switchLayer()" value="cycle" /> Street map
        </label>
      </div>

      <div *ngIf="realArea" class="results">
        <p>ğŸ“ Projected area: ({{ (area! * 10.7639) | number:'1.0-0' }} ftÂ²)</p>
        <p>ğŸ  Real area:  ({{ (realArea! * 10.7639) | number:'1.0-0' }} ftÂ²)</p>
        <p>ğŸ”² In "squares": {{ areaSq | number:'1.1-1' }} squares</p>
      </div>
    </div>
  
    <!-- Fixed right search bar -->
    <div class="search-bar fixed-search">
      <input
        type="text"
        [(ngModel)]="searchQuery"
        (input)="onSearchQueryChange()"
        placeholder="Enter address..."
      />
      <ul *ngIf="suggestions.length" class="autocomplete">
        <li *ngFor="let s of suggestions" (click)="selectSuggestion(s)">
          {{ s.display_name }}
        </li>
      </ul>
      <button (click)="searchAddress()">ğŸ”</button>
    </div>
    
  </div>